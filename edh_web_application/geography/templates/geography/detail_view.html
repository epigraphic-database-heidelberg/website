{% extends 'base.html' %}

{% block header %}
{% block title %}EDH: {{ title }} {% endblock %}
{% endblock %}

{% block app_content %}
<h1>{{ title }}</h1>
<h2>{{ data['name'] | safe }}</h2>
<h3 class="uri">{{ _("Canonical URI") }}:<br class="visible-xs" />
    <span id="canonical_uri">
        <a href="https://edh-www.adw.uni-heidelberg.de/edh/geographie/{{data['id']}}">https://edh-www.adw.uni-heidelberg.de/edh/geographie/{{data['id']}}</a>
        <i class="far fa-copy fa-lg" style="color:#1F6B3B; padding-bottom:0px; cursor:pointer; margin-left:.5em;margin-right:.5em" onclick="copy2clipboard('{{ _('copied!') }}')" alt="{{ _('Copy URI to clipboard')}}" title="{{ _('Copy URI to clipboard')}}"></i>
    </span>
    <span id="copy_button" style="color:#aa2222; font-size:0.7em"></span>
</h3>
<div>
    <div class="detail_block" style="margin-bottom:2em;">

        <div class="detail_block_content">
            <section class="detail_block_content_row">
                <div id="map_canvas" style="width:100%;height:350px;border: 1px solid #aaa;margin-bottom:1.5em; margin-left:8px"></div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('province') }}:</div>
                <div class="detail_block_content_row_text"><i class="fas fa-external-link-alt"></i> <a href="./edh/geographie/{{ data['provinz_id'] }}">{{ data['provinz'] }}</a></div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('country') }}:</div>
                <div class="detail_block_content_row_text">{{data['land']}}</div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('ancient find spot') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['fo_antik'] %}
                        {{data['fo_antik']}}
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('modern find spot') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['fo_modern'] %}
                        {{data['fo_modern']}}
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('find spot') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['fundstelle'] %}
                        {{data['fundstelle']|replace("{","<span style='color:red'>")|replace("}","</span>")|safe}}
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('verw_bezirk') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['verw_bezirk'] %}
                        {{data['verw_bezirk']}}
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('comment') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['kommentar'] %}
                        {{ data['kommentar']|safe }}
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('Pleiades-ID') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['pleiades_id_1'] %}
                        <i class="fas fa-external-link-alt"></i>
                        <a href="https://pleiades.stoa.org/places/{{data['pleiades_id_1']}}">{{data['pleiades_id_1']}}</a>
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('Trismegistos Geo-ID') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['trismegistos_geo_id'] %}
                        <i class="fas fa-external-link-alt"></i>
                        <a href="https://www.trismegistos.org/place/{{data['trismegistos_geo_id']}}">{{data['trismegistos_geo_id']}}</a>
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('Geonames ID') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['geonames_id_1'] %}
                        <i class="fas fa-external-link-alt"></i>
                        <a href="https://www.geonames.org/{{data['geonames_id_1']}}">{{data['geonames_id_1']}}</a>
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </section>
            {% if data['bearbeiter'] != "Db2inst1" %}
                <section class="detail_block_content_row">
                    <div class="detail_block_content_row_header">{{ _('responsible individual') }}:</div>
                    <div class="detail_block_content_row_text">{{data['bearbeiter']}}</div>
                </section>
            {% endif %}
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('last update') }}:</div>
                <div class="detail_block_content_row_text">{{data['datum']}}</div>
            </section>
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('finished') }}:</div>
                <div class="detail_block_content_row_text">
                    {% if data['bearbeitet'] %}{{_('Yes')}}
                    {% else %}{{_('No')}}
                    {% endif %}
                </div>
            </section>
        </div>
    </div>
    <div><h3>{{ _('Inscriptions linked to this findspot')}}</h3></div>
    <div>&nbsp;</div>
</div>

{% endblock %}
{% block scripts %}
{{ super() }}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
<script src=".{{url_for('static', filename='js/copy2clipboard.js')}}"></script>
<script src=".{{url_for('geography.static', filename='js/bing.js')}}"></script>
<script type="text/javascript">
    var BING_KEY = 'AhpTG22M_rzQEp8Q4c4edHpmIWXhwrQE65lztW3S7MsvB4cpUuya0fUgJscUfXMa'
    var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
            '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
        mbUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoid2VuYW11biIsImEiOiJCcUl0ZWRzIn0.zxs-a0hWY3La5kF4CWAVug';
    var streets  = L.tileLayer(mbUrl, {id: 'mapbox.streets', minZoom:5, attribution: mbAttr}),
        sat = L.tileLayer(mbUrl, {id: 'mapbox.streets-satellite', minZoom:5, attribution: mbAttr}),
        pelagios = L.tileLayer('https://dh.gu.se/tiles/imperium/{z}/{x}/{y}.png', {id: 'pelagios', maxZoom:11, minZoom:5, attribution: 'Map Data: <a href="https://dare.ht.lu.se">DARE</a>'}),
        bing_satellite = new L.BingLayer(BING_KEY, {'type': 'AerialWithLabels'}),
        openTopoMap = Thunderforest_Landscape = L.tileLayer('https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey={apikey}', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>, &copy; <a href="https://www.thunderforest.com/">Thunderforest</a>',
            apikey: 'aaeccd3a44a74ce58324c2a455c58a98',
            minZoom: 5});
    var map = L.map('map_canvas', {
        center: [{{data['koordinaten_1']}}],
        zoom: 9,
        layers: [streets],
        zoomControl: true,
        preferCanvas: true,
        scrollWheelZoom: false
    });
    var baseLayers = {
        "Streets": streets,
        "Mapbox Satellite": sat,
        "Bing Satellite": bing_satellite,
        "Pelagios": pelagios,
        "Topo": openTopoMap
    };
    map.zoomControl.setPosition('topright');
    var overlays = {};
    L.control.layers(baseLayers, overlays, {position: 'topleft'}).addTo(map);
    var marker = L.marker([{{data['koordinaten_1']}}]).addTo(map);
</script>
{% endblock %}