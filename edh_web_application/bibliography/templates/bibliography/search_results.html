{% extends 'base.html' %}

{% block header %}
{% block title %}EDH: {{ title }} {% endblock %}
{% endblock %}

{% block app_content %}
<h1>{{ title }}</h1>
<p>{{_("The search resulted in ")}} {{number_of_hits}} {{_("hits.")}}</p>
<div style="text-align:center">
    <nav aria-label="Search results pages">
        <ul class="pagination justify-content-center">
            <li class="page-item">
                <a class="page-link" href="
                    {% if (data['metadata']['start']|int - data['metadata']['rows']|int) > 0 %}
                        .{{data['metadata']['url_without_pagination_parameters']}}&start={{data['metadata']['start']|int - data['metadata']['rows']|int }}&anzahl={{data['metadata']['rows']}}
                    {% else %}
                        .{{data['metadata']['url_without_pagination_parameters']}}&start=0&anzahl={{data['metadata']['rows']}}
                    {% endif %}
                    " aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                </a>
            </li>
            {% for hit in range((data['metadata']['number_of_hits']|int / data['metadata']['rows'])|int + 1) %}
                {% if (data['metadata']['start']|int ) / data['metadata']['rows']|int == hit %}
                <li class="page-item disabled">
                    <a class="page-link" href="#">{{ hit + 1 }}</a>
                </li>
                {% else %}
                <li class="page-item">
                    <a class="page-link" href=".{{data['metadata']['url_without_pagination_parameters']}}&start={{ hit * data['metadata']['rows'] }}&anzahl={{data['metadata']['rows']}}">{{ hit + 1 }}</a>
                </li>
                {% endif %}
            {% endfor%}
            <li class="page-item">
                <a class="page-link" href="
                {% if (data['metadata']['start']|int + data['metadata']['rows']|int) <= data['metadata']['number_of_hits']|int %}
                    .{{data['metadata']['url_without_pagination_parameters']}}&start={{data['metadata']['start']|int + data['metadata']['rows']|int }}&anzahl={{data['metadata']['rows']}}
                {% endif %}
                " aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
<div>
    {% set count = namespace(value=0) %}
    {% for d in data['items'] %}
    {% set count.value = count.value + 1 %}
    <div class="detail_block">
        <div class="detail_block_header">
            <span class="detail_block_header_text"><a href="/edh/bibliographie/{{ d['b_nr'] }}">{{_('Number')}} {{count.value + data['metadata']['start']|int}}: {{ d['b_nr'] }} {{ _('&ndash; open detailed view...') }}</a></span>
        </div>
        <div class="detail_block_content">
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('author') }}:</div>
                <div class="detail_block_content_row_text">
                    {% set author_list = d['autor'].split(' - ') %}
                    {% for author in author_list %}
                        <a href="/bibliographie/suche?author={{ author }}" class="pfeil">{{ author }}</a> &nbsp;
                    {% endfor %}
                </div>
            </section>
            {% if d['titel'] %}
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('title') }}:</div>
                <div class="detail_block_content_row_text">{{ d['titel'] }}</div>
            </section>
            {% endif %}
            {% if d['publikation'] %}
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('publication') }}</div>
                <div class="detail_block_content_row_text"><a href="/bibliographie/suche?publication={{ d['publikation'] }}" class="pfeil">{{ d['publikation'] }}</a></div>
            </section>
            {% endif %}
            {% if d['band'] %}
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('volume') }}:</div>
                <div class="detail_block_content_row_text">{{ d['band'] }}</div>
            </section>
            {% endif %}
            {% if d['jahr'] %}
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('years') }}:</div>
                <div class="detail_block_content_row_text">{{ d['jahr'] }}</div>
            </section>
            {% endif %}
            {% if d['seiten'] %}
            <section class="detail_block_content_row">
                <div class="detail_block_content_row_header">{{ _('pages') }}:</div>
                <div class="detail_block_content_row_text">{{ d['seiten'] }}</div>
            </section>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
<div style="text-align:center">
    <nav aria-label="Search results pages">
        <ul class="pagination justify-content-center">
            <li class="page-item">
                <a class="page-link" href="
                    {% if (data['metadata']['start']|int - data['metadata']['rows']|int) > 0 %}
                        .{{data['metadata']['url_without_pagination_parameters']}}&start={{data['metadata']['start']|int - data['metadata']['rows']|int }}&anzahl={{data['metadata']['rows']}}
                    {% else %}
                        .{{data['metadata']['url_without_pagination_parameters']}}&start=0&anzahl={{data['metadata']['rows']}}
                    {% endif %}
                    " aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                </a>
            </li>
            {% for hit in range((data['metadata']['number_of_hits']|int / data['metadata']['rows'])|int + 1) %}
                {% if (data['metadata']['start']|int ) / data['metadata']['rows']|int == hit %}
                <li class="page-item disabled">
                    <a class="page-link" href="#">{{ hit + 1 }}</a>
                </li>
                {% else %}
                <li class="page-item">
                    <a class="page-link" href=".{{data['metadata']['url_without_pagination_parameters']}}&start={{ hit * data['metadata']['rows'] }}&anzahl={{data['metadata']['rows']}}">{{ hit + 1 }}</a>
                </li>
                {% endif %}
            {% endfor%}
            <li class="page-item">
                <a class="page-link" href="
                {% if (data['metadata']['start']|int + data['metadata']['rows']|int) <= data['metadata']['number_of_hits']|int %}
                    .{{data['metadata']['url_without_pagination_parameters']}}&start={{data['metadata']['start']|int + data['metadata']['rows']|int }}&anzahl={{data['metadata']['rows']}}
                {% endif %}
                " aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
<div>
{% endblock %}
